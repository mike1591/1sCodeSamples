&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)
	Если Модифицированность Тогда 
		
		Отказ = Истина ; 
		СтандартнаяОбработка = Ложь  ; 
		
		Оповещение = Новый ОписаниеОповещения("ВопросПередЗакрытием",ЭтотОбъект) ;
		ПоказатьВопрос(Оповещение,"Сохранить изменения настроек обмена ?",РежимДиалогаВопрос.ДаНетОтмена) ;	
		
	КонецЕсли ;	
	
КонецПроцедуры

&НаКлиенте
Процедура ВопросПередЗакрытием(РезультатВопроса,ДопПараметры) Экспорт 
	
	Если РезультатВопроса = КодВозвратаДиалога.Да Тогда
		СохранитьНастройкиОбменаНаСервере();
		Модифицированность = Ложь  ;
		Закрыть();
	ИначеЕсли РезультатВопроса = КодВозвратаДиалога.Нет Тогда 
		Модифицированность = Ложь  ;
		Закрыть();
	Иначе // Отмена
			
	КонецЕсли; 
	

КонецПроцедуры

