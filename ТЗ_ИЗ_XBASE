//////////////////////////////////////////////////////////////
// Загрузка файла XBase в таблицу значений 
//  Параметры :  
//    ДанныеФайла - ДвоичныеДанные 
//    Кодировка  - тип КодировкаXBase По  умлчанию  КодировкаXBase.ANSI
////////
// Возвращаемое знаечние - таблица значений 
// Пример Вызова :   
//   ДвоичныеДанные = Новый ДвоичныеДанные(КаталогОбработки+ИмяФайла) ;
//   ТаблицаИзXBase = ТаблицаИзXBase(ДвоичныеДанные,КодировкаXBase.ANSI) ;   
//////////////////////////////////////////

Функция ТаблицаИзXBase(ДанныеФайла,Кодировка=Неопределено) Экспорт
	ОтДата   = Новый ОписаниеТипов("Дата");
	ОтБулево = Новый ОписаниеТипов("Булево");
	
	Данные = Новый ТаблицаЗначений ;	
	
	ИмяВремФайла =  КаталогВременныхФайлов()+"t.dbf";
	ДанныеФайла.Записать(ИмяВремФайла);
	
	База = Новый XBase;
	База.ОткрытьФайл(ИмяВремФайла,,Истина);
	База.Кодировка = ?(Кодировка=Неопределено,КодировкаXBase.ANSI,Кодировка);
	Для каждого поле из  База.поля Цикл
		Если Поле.Тип = "L" Тогда 
			Данные.Колонки.Добавить(поле.Имя,ОтБулево);
		ИначеЕсли Поле.Тип = "D" Тогда 
			Данные.Колонки.Добавить(поле.Имя,ОтДата);
		Иначе
			Данные.Колонки.Добавить(поле.Имя);
		КонецЕсли ;	
	КонецЦикла;	
	База.Кодировка = Кодировка;
	Пока Не База.ВКонце() Цикл
		стр = Данные.Добавить();
		ЗаполнитьЗначенияСвойств(стр,База);
		База.Следующая();
	КонецЦикла ;  
	База.ЗакрытьФайл();
	УдалитьФайлы(ИмяВремФайла);
	
	Возврат Данные ; 
КонецФункции 
